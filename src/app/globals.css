@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light mode colors - iOS inspired */
    --background: 0 0% 100%;
    --foreground: 0 0% 9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 9%;
    --primary: 221 83% 53%;
    --primary-foreground: 0 0% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 0 0% 9%;
    --muted: 210 40% 96%;
    --muted-foreground: 0 0% 45%;
    --accent: 210 40% 96%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 221 83% 53%;
    --radius: 0.5rem;
  }

  .dark {
    /* Dark mode colors - iOS inspired */
    --background: 0 0% 6%;
    --foreground: 0 0% 98%;
    --card: 240 10% 9%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 9%;
    --popover-foreground: 0 0% 98%;
    --primary: 221 83% 53%;
    --primary-foreground: 0 0% 9%;
    --secondary: 240 4% 16%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 4% 16%;
    --muted-foreground: 240 5% 65%;
    --accent: 240 4% 16%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 63% 31%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 4% 16%;
    --input: 240 4% 16%;
    --ring: 221 83% 53%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    @apply scroll-smooth;
    /* Respect user preference for reduced motion */
    scroll-behavior: smooth;
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
    
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
  }

  /* Improved focus styles for accessibility */
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }

  /* Better text rendering */
  h1, h2, h3, h4, h5, h6 {
    text-rendering: optimizeLegibility;
  }
}

@layer components {
  /* Note: Typography sizes are defined in tailwind.config.ts with font-weight and letter-spacing */
  /* These utility classes can be used directly: text-large-title, text-title1, text-title2, etc. */

  /* Unified Button System */
  .btn {
    @apply inline-flex items-center justify-center whitespace-nowrap text-subhead font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50;
    /* iOS standard touch target */
    min-height: 44px;
    min-width: 44px;
  }

  .btn-primary {
    @apply bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm active:scale-95;
  }

  .btn-secondary {
    @apply bg-secondary text-secondary-foreground hover:bg-secondary/80 border border-input shadow-sm active:scale-95;
  }

  .btn-outline {
    @apply border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm active:scale-95;
  }

  .btn-ghost {
    @apply hover:bg-accent hover:text-accent-foreground active:scale-95;
  }

  .btn-destructive {
    @apply bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm active:scale-95;
  }

  /* Button sizes */
  .btn-sm {
    @apply h-9 px-3 text-caption1;
    min-height: 36px;
  }

  .btn-default {
    @apply h-11 px-4;
  }

  .btn-lg {
    @apply h-12 px-6 text-callout;
    min-height: 48px;
  }

  .btn-icon {
    @apply h-11 w-11;
  }

  /* Unified Card System */
  .card {
    @apply rounded-lg border bg-card text-card-foreground shadow-sm dark:shadow-dark-sm transition-shadow duration-200;
  }

  .card-interactive {
    @apply card hover:shadow-md dark:hover:shadow-dark-md cursor-pointer transition-all duration-200 hover:-translate-y-0.5 active:translate-y-0;
  }

  .card-header {
    @apply flex flex-col space-y-1.5 p-6;
  }

  .card-title {
    @apply text-title3 leading-none tracking-tight;
  }

  .card-description {
    @apply text-subhead text-muted-foreground;
  }

  .card-content {
    @apply p-6 pt-0;
  }

  .card-footer {
    @apply flex items-center p-6 pt-0;
  }

  /* Unified Input System */
  .input {
    @apply flex h-11 w-full rounded-md border border-input bg-background px-3 py-2 text-body ring-offset-background file:border-0 file:bg-transparent file:text-subhead file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-200;
    min-height: 44px;
  }

  /* Container System */
  .container-app {
    @apply w-full mx-auto px-4 sm:px-6 lg:px-8;
    max-width: 1280px;
  }

  .container-narrow {
    @apply w-full mx-auto px-4 sm:px-6 lg:px-8;
    max-width: 896px;
  }

  .container-wide {
    @apply w-full mx-auto px-4 sm:px-6 lg:px-8;
    max-width: 1536px;
  }

  /* Section Spacing */
  .section-spacing {
    @apply py-12 md:py-16 lg:py-20;
  }

  .section-spacing-sm {
    @apply py-8 md:py-12 lg:py-16;
  }

  /* Grid Systems */
  .grid-auto-fit {
    @apply grid gap-6;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  }

  .grid-auto-fill {
    @apply grid gap-6;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  }

  /* Responsive Grid */
  .grid-responsive-cards {
    @apply grid gap-4 sm:gap-6;
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .grid-responsive-cards {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .grid-responsive-cards {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (min-width: 1280px) {
    .grid-responsive-cards {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* Empty States */
  .empty-state {
    @apply flex flex-col items-center justify-center text-center p-8 space-y-4;
  }

  .empty-state-icon {
    @apply text-4xl opacity-50;
  }

  .empty-state-title {
    @apply text-title3 text-muted-foreground;
  }

  .empty-state-description {
    @apply text-body text-muted-foreground max-w-md;
  }

  /* Loading States */
  .skeleton {
    @apply animate-pulse bg-muted rounded;
  }

  /* Navigation */
  .nav-link {
    @apply inline-flex items-center justify-center h-11 px-4 text-subhead font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50;
    min-height: 44px;
  }

  .nav-link-active {
    @apply bg-accent text-accent-foreground;
  }

  /* Badge System */
  .badge {
    @apply inline-flex items-center rounded-full border px-2.5 py-0.5 text-caption1 font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2;
  }

  .badge-default {
    @apply border-transparent bg-primary text-primary-foreground hover:bg-primary/80;
  }

  .badge-secondary {
    @apply border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80;
  }

  .badge-destructive {
    @apply border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80;
  }

  .badge-outline {
    @apply text-foreground;
  }

  /* Alert System */
  .alert {
    @apply relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground;
  }

  .alert-destructive {
    @apply border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive;
  }

  .alert-title {
    @apply mb-1 font-medium leading-none tracking-tight;
  }

  .alert-description {
    @apply text-subhead [&_p]:leading-relaxed;
  }
}

/* Manual Reader Styles - Updated with unified design system */
@layer components {
  .prose-yoga {
    @apply prose prose-gray dark:prose-invert max-w-none;
  }

  .prose-yoga h1 {
    @apply text-title1 text-foreground mb-4;
  }

  .prose-yoga h2 {
    @apply text-title2 text-foreground mt-8 mb-4 border-b border-border pb-2;
  }

  .prose-yoga h3 {
    @apply text-title3 text-foreground mt-6 mb-3;
  }

  .prose-yoga h4 {
    @apply text-headline text-foreground mt-4 mb-2;
  }

  .prose-yoga p {
    @apply text-body mb-4 leading-relaxed;
  }

  .prose-yoga strong {
    @apply font-semibold text-primary;
  }

  .prose-yoga em {
    @apply italic text-primary/80 font-medium;
  }

  /* Sanskrit term styling */
  .sanskrit-term {
    @apply cursor-help border-b border-dotted border-primary/50 text-primary hover:text-primary/80 transition-colors;
  }

  /* Callout boxes for key concepts */
  .concept-box {
    @apply bg-primary/5 border-l-4 border-primary p-4 my-6 rounded-r-lg;
  }

  .concept-box h4 {
    @apply text-primary font-semibold mb-2;
  }

  .concept-box p {
    @apply text-primary/80 mb-0;
  }

  /* Sanskrit definition boxes */
  .sanskrit-definition {
    @apply bg-accent border-l-4 border-accent-foreground/20 p-4 my-4 rounded-r-lg;
  }

  .sanskrit-definition .sanskrit-term-name {
    @apply font-semibold text-accent-foreground;
  }

  .sanskrit-definition .sanskrit-meaning {
    @apply text-accent-foreground/80 text-subhead;
  }

  /* Reading progress indicator */
  .reading-progress {
    @apply fixed top-0 left-0 h-1 bg-gradient-to-r from-primary to-primary/60 z-50 transition-all duration-300;
  }

  /* Notes panel */
  .notes-panel {
    @apply card p-4;
  }

  .notes-panel textarea {
    @apply input resize-none;
  }
}

/* Mountain Meditation Landing Page - Simplified and responsive */
@layer components {
  .hero-meditation {
    @apply relative w-full h-screen min-h-[600px] overflow-hidden;
    background: linear-gradient(180deg, 
        hsl(47, 100%, 97%) 0%, 
        hsl(47, 100%, 95%) 15%,
        hsl(204, 100%, 97%) 35%, 
        hsl(204, 100%, 95%) 55%,
        hsl(225, 100%, 98%) 75%, 
        hsl(270, 100%, 98%) 100%);
  }

  @media (prefers-color-scheme: dark) {
    .hero-meditation {
      background: linear-gradient(180deg, 
          hsl(240, 10%, 8%) 0%, 
          hsl(240, 10%, 6%) 15%,
          hsl(240, 10%, 4%) 35%, 
          hsl(240, 10%, 6%) 55%,
          hsl(240, 10%, 8%) 75%, 
          hsl(240, 10%, 10%) 100%);
    }
  }

  /* Mountain silhouettes - simplified */
  .mountains {
    @apply absolute bottom-0 left-0 w-full h-2/5 z-10;
  }

  .mountain-layer {
    @apply absolute bottom-0 w-full h-full;
  }

  .mountain-back {
    @apply opacity-20;
    background: linear-gradient(to bottom, 
        hsl(var(--primary) / 0.1) 0%,
        hsl(var(--primary) / 0.15) 100%);
    clip-path: polygon(0% 100%, 0% 60%, 20% 45%, 35% 65%, 50% 40%, 65% 55%, 80% 35%, 100% 50%, 100% 100%);
  }

  @media (prefers-reduced-motion: no-preference) {
    .mountain-back {
      animation: gentle-float 15s ease-in-out infinite;
    }
  }

  .mountain-mid {
    @apply opacity-30;
    background: linear-gradient(to bottom, 
        hsl(var(--primary) / 0.2) 0%,
        hsl(var(--primary) / 0.25) 100%);
    clip-path: polygon(0% 100%, 0% 80%, 25% 50%, 40% 70%, 60% 45%, 75% 60%, 100% 40%, 100% 100%);
  }

  @media (prefers-reduced-motion: no-preference) {
    .mountain-mid {
      animation: gentle-float 12s ease-in-out infinite reverse;
    }
  }

  .mountain-front {
    @apply opacity-40;
    background: linear-gradient(to bottom, 
        hsl(var(--primary) / 0.3) 0%,
        hsl(var(--primary) / 0.2) 100%);
    clip-path: polygon(0% 100%, 0% 90%, 30% 65%, 45% 80%, 70% 60%, 85% 75%, 100% 70%, 100% 100%);
  }

  @media (prefers-reduced-motion: no-preference) {
    .mountain-front {
      animation: gentle-float 18s ease-in-out infinite;
    }
  }

  /* Meditation figure */
  .meditation-figure {
    @apply absolute bottom-1/4 left-1/4 z-20 w-32 h-40 md:w-40 md:h-48;
  }

  @media (prefers-reduced-motion: no-preference) {
    .meditation-figure {
      animation: gentle-breathing 5s ease-in-out infinite;
    }
  }

  .figure-body {
    @apply absolute bottom-0 left-1/2 transform -translate-x-1/2 w-12 h-16 md:w-16 md:h-20 rounded-t-full;
    background: linear-gradient(145deg, 
        hsl(var(--primary) / 0.2) 0%, 
        hsl(var(--primary) / 0.15) 50%, 
        hsl(var(--primary) / 0.1) 100%);
  }

  .figure-head {
    @apply absolute bottom-14 md:bottom-16 left-1/2 transform -translate-x-1/2 w-8 h-8 md:w-10 md:h-10 rounded-full;
    background: linear-gradient(145deg, 
        hsl(var(--primary) / 0.18) 0%, 
        hsl(var(--primary) / 0.12) 100%);
  }

  /* Breathing sphere - simplified */
  .breathing-sphere {
    @apply absolute top-1/3 right-1/4 transform -translate-y-1/2 w-64 h-64 md:w-80 md:h-80 z-10;
  }

  .sphere-core {
    @apply w-full h-full rounded-full relative;
    background: radial-gradient(circle at 25% 25%, 
        hsl(var(--background) / 0.4) 0%,
        hsl(var(--primary) / 0.25) 20%,
        hsl(var(--primary) / 0.2) 50%,
        hsl(var(--primary) / 0.15) 80%,
        hsl(var(--primary) / 0.1) 100%);
    backdrop-filter: blur(2px);
    border: 1px solid hsl(var(--border) / 0.2);
  }

  @media (prefers-reduced-motion: no-preference) {
    .sphere-core {
      animation: sphere-pulse 4s ease-in-out infinite;
    }
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .hero-meditation {
      @apply min-h-[500px];
    }
    
    .breathing-sphere {
      @apply w-48 h-48 right-[10%] top-[30%];
    }
    
    .meditation-figure {
      @apply w-24 h-32 left-[15%] bottom-[25%];
    }
    
    .mountains {
      @apply h-[30%];
    }
  }

  @media (max-width: 480px) {
    .breathing-sphere {
      @apply w-36 h-36 right-[5%];
    }
    
    .meditation-figure {
      @apply w-20 h-28 left-[10%];
    }
  }
}

/* Animations - moved to base layer */
@layer base {
  @keyframes gentle-float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-8px); }
  }

  @keyframes gentle-breathing {
    0%, 100% { 
      transform: translateY(0px) scale(1); 
    }
    50% { 
      transform: translateY(-5px) scale(1.02); 
    }
  }

  @keyframes sphere-pulse {
    0%, 100% { 
      transform: scale(1); 
      opacity: 0.7;
    }
    50% { 
      transform: scale(1.05); 
      opacity: 0.9;
    }
  }
}

/* Utility Classes */
@layer utilities {
  /* Responsive visibility */
  .mobile-only {
    @apply block md:hidden;
  }
  
  .tablet-up {
    @apply hidden md:block;
  }
  
  .desktop-only {
    @apply hidden lg:block;
  }

  /* Touch targets */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
  
  .touch-target-large {
    min-height: 48px;
    min-width: 48px;
  }

  /* Text alignment helpers */
  .text-balance {
    text-wrap: balance;
  }

  /* Improved readability */
  .prose-balance h1,
  .prose-balance h2,
  .prose-balance h3 {
    text-wrap: balance;
  }

  /* Focus states */
  .focus-ring {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
  }

  /* Truncate helpers */
  .truncate-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }

  .truncate-3 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
}

/* Print Styles for Yoga Content */
@media print {
  /* Reset for print */
  *, *::before, *::after {
    background: transparent !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Hide navigation and non-essential elements */
  nav, .navbar, .navigation, .sidebar, .floating-action, 
  .print-hide, button:not(.print-show), .btn:not(.print-show),
  .social-share, .advertisement, .cookie-banner {
    display: none !important;
  }

  /* Page setup */
  @page {
    margin: 0.75in;
    size: letter;
  }

  /* Typography for print */
  body {
    font-family: "Times New Roman", serif !important;
    font-size: 12pt !important;
    line-height: 1.4 !important;
    color: black !important;
  }

  h1 { font-size: 18pt !important; margin-bottom: 12pt !important; }
  h2 { font-size: 16pt !important; margin-bottom: 10pt !important; }
  h3 { font-size: 14pt !important; margin-bottom: 8pt !important; }
  h4 { font-size: 12pt !important; margin-bottom: 6pt !important; }

  /* Printable content containers */
  .printable-pose-card {
    break-inside: avoid !important;
    margin-bottom: 18pt !important;
    border: 1pt solid #ccc !important;
    padding: 12pt !important;
    page-break-inside: avoid !important;
  }

  .printable-sequence {
    break-inside: auto !important;
  }

  .sequence-header {
    break-inside: avoid !important;
    margin-bottom: 18pt !important;
    border: 1pt solid #ccc !important;
    padding: 12pt !important;
  }

  .sequence-overview {
    break-inside: avoid !important;
    margin-bottom: 18pt !important;
  }

  .pose-detail {
    break-inside: avoid !important;
    margin-bottom: 18pt !important;
    page-break-inside: avoid !important;
  }

  .sequence-footer {
    break-before: page !important;
    margin-top: 18pt !important;
    border-top: 1pt solid #ccc !important;
    padding-top: 12pt !important;
  }

  /* Images for print */
  img {
    max-width: 100% !important;
    height: auto !important;
    break-inside: avoid !important;
  }

  /* Tables for print */
  table {
    border-collapse: collapse !important;
    width: 100% !important;
  }

  table, th, td {
    border: 1pt solid #ccc !important;
  }

  th, td {
    padding: 6pt !important;
    text-align: left !important;
  }

  /* Lists for print */
  ul, ol {
    margin: 6pt 0 !important;
    padding-left: 18pt !important;
  }

  li {
    margin: 3pt 0 !important;
  }

  /* Print-specific utilities */
  .print-only {
    display: block !important;
  }

  .no-print {
    display: none !important;
  }

  /* Ensure no orphans/widows */
  p, h1, h2, h3, h4, h5, h6 {
    orphans: 3 !important;
    widows: 3 !important;
  }

  h1, h2, h3, h4, h5, h6 {
    break-after: avoid !important;
  }

  /* Links for print */
  a[href]:after {
    content: " (" attr(href) ")" !important;
    font-size: 10pt !important;
    color: #666 !important;
  }

  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "" !important;
  }

  /* Cards and containers */
  .card, .bg-white, .bg-gray-50 {
    background: white !important;
    border: 1pt solid #ccc !important;
  }

  /* Ensure good contrast */
  .text-gray-500, .text-gray-600, .text-muted-foreground {
    color: #333 !important;
  }

  .text-blue-600, .text-primary {
    color: #000 !important;
    font-weight: bold !important;
  }

  /* Grid layouts for print */
  .grid {
    display: block !important;
  }

  .grid > * {
    margin-bottom: 12pt !important;
  }
}
